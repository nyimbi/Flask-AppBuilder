{% extends "appbuilder/base.html" %}

{% block head_css %}
  {{ super() }}
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.css" rel="stylesheet">
  <style>
    :root {
      --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-success: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      --gradient-info: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-warning: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-danger: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
      --shadow-soft: 0 4px 25px 0 rgba(0, 0, 0, 0.1);
      --shadow-hover: 0 8px 40px 0 rgba(0, 0, 0, 0.15);
      --border-radius: 12px;
      --animation-duration: 0.3s;
    }
    
    /* Global Styles */
    body {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    /* Header Styles */
    .dashboard-header {
      background: var(--gradient-primary);
      color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-soft);
      margin-bottom: 2rem;
      overflow: hidden;
      position: relative;
    }
    
    .dashboard-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.05)"/></pattern></defs><rect width="100%" height="100%" fill="url(%23grain)"/></svg>');
      opacity: 0.3;
    }
    
    .dashboard-header .card-body {
      position: relative;
      z-index: 1;
    }
    
    .welcome-text {
      font-size: 2.5rem;
      font-weight: 300;
      margin-bottom: 0.5rem;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .welcome-subtitle {
      font-size: 1.1rem;
      opacity: 0.9;
      font-weight: 300;
    }
    
    .system-status {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
    }
    
    .status-indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #00ff88;
      box-shadow: 0 0 8px rgba(0, 255, 136, 0.6);
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .stat-card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-soft);
      transition: all var(--animation-duration) ease;
      overflow: hidden;
      position: relative;
      border: none;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-hover);
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: var(--gradient-primary);
    }
    
    .stat-card.primary::before { background: var(--gradient-primary); }
    .stat-card.success::before { background: var(--gradient-success); }
    .stat-card.info::before { background: var(--gradient-info); }
    .stat-card.warning::before { background: var(--gradient-warning); }
    .stat-card.danger::before { background: var(--gradient-danger); }
    
    .stat-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: white;
      margin-bottom: 1rem;
    }
    
    .stat-icon.primary { background: var(--gradient-primary); }
    .stat-icon.success { background: var(--gradient-success); }
    .stat-icon.info { background: var(--gradient-info); }
    .stat-icon.warning { background: var(--gradient-warning); }
    .stat-icon.danger { background: var(--gradient-danger); }
    
    .stat-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: #2c3e50;
      line-height: 1;
      margin-bottom: 0.5rem;
    }
    
    .stat-label {
      font-size: 1rem;
      font-weight: 600;
      color: #7f8c8d;
      margin-bottom: 0.5rem;
    }
    
    .stat-change {
      font-size: 0.85rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .stat-change.positive { color: #27ae60; }
    .stat-change.negative { color: #e74c3c; }
    .stat-change.neutral { color: #7f8c8d; }
    
    /* Quick Actions */
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }
    
    .action-card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-soft);
      transition: all var(--animation-duration) ease;
      text-decoration: none;
      color: inherit;
      overflow: hidden;
      position: relative;
      border: none;
    }
    
    .action-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-hover);
      text-decoration: none;
      color: inherit;
    }
    
    .action-icon {
      width: 50px;
      height: 50px;
      border-radius: var(--border-radius);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      color: white;
      margin-bottom: 1rem;
    }
    
    .action-card .badge {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      font-size: 0.7rem;
      padding: 0.25rem 0.5rem;
    }
    
    /* Charts Section */
    .charts-section {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 2rem;
      margin-bottom: 2rem;
    }
    
    .chart-card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-soft);
      border: none;
    }
    
    .chart-container {
      position: relative;
      height: 300px;
      padding: 1rem;
    }
    
    /* Activity Feed */
    .activity-feed {
      max-height: 400px;
      overflow-y: auto;
    }
    
    .activity-item {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      padding: 1rem;
      border-bottom: 1px solid #ecf0f1;
      transition: background var(--animation-duration) ease;
    }
    
    .activity-item:hover {
      background: #f8f9fa;
    }
    
    .activity-item:last-child {
      border-bottom: none;
    }
    
    .activity-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      color: white;
      flex-shrink: 0;
    }
    
    .activity-content h6 {
      margin: 0 0 0.25rem 0;
      font-size: 0.95rem;
      font-weight: 600;
      color: #2c3e50;
    }
    
    .activity-content p {
      margin: 0 0 0.25rem 0;
      font-size: 0.85rem;
      color: #7f8c8d;
    }
    
    .activity-time {
      font-size: 0.75rem;
      color: #95a5a6;
    }
    
    /* Notifications */
    .notification-item {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      padding: 1rem;
      border-left: 4px solid transparent;
      background: white;
      margin-bottom: 0.5rem;
      border-radius: 0 var(--border-radius) var(--border-radius) 0;
      box-shadow: var(--shadow-soft);
      transition: all var(--animation-duration) ease;
    }
    
    .notification-item:hover {
      transform: translateX(5px);
    }
    
    .notification-item.info { border-left-color: #3498db; }
    .notification-item.warning { border-left-color: #f39c12; }
    .notification-item.success { border-left-color: #27ae60; }
    .notification-item.danger { border-left-color: #e74c3c; }
    
    .notification-item.unread {
      background: #f8f9fa;
      font-weight: 600;
    }
    
    /* Performance Metrics */
    .performance-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }
    
    .performance-item {
      text-align: center;
      padding: 1.5rem 1rem;
    }
    
    .performance-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 0.5rem;
    }
    
    .performance-label {
      font-size: 0.9rem;
      color: #7f8c8d;
      margin-bottom: 1rem;
    }
    
    .progress-ring {
      width: 60px;
      height: 60px;
      margin: 0 auto;
      position: relative;
    }
    
    .progress-ring svg {
      transform: rotate(-90deg);
    }
    
    .progress-ring circle {
      fill: transparent;
      stroke-width: 4;
      stroke-linecap: round;
    }
    
    .progress-ring .bg {
      stroke: #ecf0f1;
    }
    
    .progress-ring .progress {
      stroke: #3498db;
      stroke-dasharray: 157;
      stroke-dashoffset: 157;
      transition: stroke-dashoffset 1s ease;
    }
    
    /* Featured Tools */
    .featured-tools {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }
    
    .tool-card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-soft);
      overflow: hidden;
      transition: all var(--animation-duration) ease;
      text-decoration: none;
      color: inherit;
    }
    
    .tool-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-hover);
      text-decoration: none;
      color: inherit;
    }
    
    .tool-image {
      height: 120px;
      background: var(--gradient-primary);
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 3rem;
    }
    
    .tool-features {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    
    .feature-badge {
      background: #ecf0f1;
      color: #7f8c8d;
      padding: 0.25rem 0.5rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 500;
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .charts-section {
        grid-template-columns: 1fr;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .quick-actions {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      }
      
      .welcome-text {
        font-size: 2rem;
      }
    }
    
    /* Loading States */
    .loading-skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
    }
    
    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    
    /* Custom Scrollbar */
    .activity-feed::-webkit-scrollbar {
      width: 6px;
    }
    
    .activity-feed::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }
    
    .activity-feed::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 3px;
    }
    
    .activity-feed::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
  </style>
{% endblock %}

{% block content %}
<div class="container-fluid">
  
  <!-- Dashboard Header -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card dashboard-header border-0">
        <div class="card-body p-4">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h1 class="welcome-text mb-2">
                {% if user_info %}{{ user_info.name.split()[0] if user_info.name.split() else 'Welcome' }}{% else %}Welcome{% endif %}!
              </h1>
              <p class="welcome-subtitle mb-3">
                Here's what's happening with your system today
              </p>
              <div class="system-status">
                <span class="status-indicator"></span>
                <span>All systems operational • Last updated {{ system_status.last_backup if system_status else 'recently' }}</span>
              </div>
            </div>
            <div class="col-md-4 text-end">
              <div class="d-flex flex-column align-items-end">
                <div class="mb-2">
                  <i class="fa fa-calendar me-2"></i>
                  <span>{{ moment().format('dddd, MMMM Do YYYY') }}</span>
                </div>
                <div class="mb-2">
                  <i class="fa fa-clock me-2"></i>
                  <span id="currentTime"></span>
                </div>
                <div>
                  <i class="fa fa-server me-2"></i>
                  <span>{{ system_info.environment if system_info else 'Production' }} v{{ system_info.version if system_info else '4.8.0' }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Stats -->
  {% if quick_stats %}
  <div class="stats-grid">
    {% for stat in quick_stats %}
    <div class="card stat-card {{ stat.color }}">
      <div class="card-body p-3">
        <div class="d-flex justify-content-between align-items-start">
          <div class="flex-grow-1">
            <div class="stat-icon {{ stat.color }}">
              <i class="{{ stat.icon }}"></i>
            </div>
            <div class="stat-value">{{ stat.value }}</div>
            <div class="stat-label">{{ stat.title }}</div>
            <div class="stat-change {{ stat.change_type }}">
              <i class="fa fa-arrow-{% if stat.change_type == 'positive' %}up{% elif stat.change_type == 'negative' %}down{% else %}right{% endif %}"></i>
              {{ stat.change }} {{ stat.description }}
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Quick Actions -->
  {% if quick_actions %}
  <div class="row mb-4">
    <div class="col-12">
      <h3 class="mb-3"><i class="fa fa-bolt"></i> Quick Actions</h3>
      <div class="quick-actions">
        {% for action in quick_actions %}
        <a href="{{ action.url }}" class="action-card">
          <div class="card-body p-3 position-relative">
            {% if action.badge %}
            <span class="badge badge-{{ action.color }}">{{ action.badge }}</span>
            {% endif %}
            <div class="action-icon {{ action.color }}" style="background: var(--gradient-{{ action.color }});">
              <i class="{{ action.icon }}"></i>
            </div>
            <h6 class="mb-1">{{ action.title }}</h6>
            <p class="text-muted small mb-0">{{ action.description }}</p>
          </div>
        </a>
        {% endfor %}
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Charts and Activity -->
  <div class="charts-section">
    <!-- Main Chart -->
    <div class="card chart-card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fa fa-chart-line"></i> User Growth
        </h5>
      </div>
      <div class="card-body">
        <div class="chart-container">
          <canvas id="userGrowthChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Activity Feed -->
    <div class="card chart-card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fa fa-stream"></i> Recent Activity
        </h5>
      </div>
      <div class="card-body p-0">
        <div class="activity-feed">
          {% if recent_activities %}
          {% for activity in recent_activities %}
          <div class="activity-item">
            <div class="activity-icon {{ activity.color }}" style="background: var(--gradient-{{ activity.color }});">
              <i class="{{ activity.icon }}"></i>
            </div>
            <div class="activity-content flex-grow-1">
              <h6>{{ activity.title }}</h6>
              <p>{{ activity.description }}</p>
              <div class="activity-time">{{ activity.timestamp.strftime('%I:%M %p') if activity.timestamp else 'Just now' }} • {{ activity.user }}</div>
            </div>
          </div>
          {% endfor %}
          {% else %}
          <div class="text-center p-4 text-muted">
            <i class="fa fa-inbox fa-2x mb-2"></i>
            <p>No recent activity</p>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Performance Metrics and Notifications -->
  <div class="row mb-4">
    <!-- Performance Metrics -->
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="fa fa-tachometer-alt"></i> Performance Metrics
          </h5>
        </div>
        <div class="card-body">
          {% if performance_metrics %}
          <div class="performance-grid">
            {% for key, metric in performance_metrics.items() %}
            <div class="performance-item">
              <div class="performance-value">{{ metric.current }}</div>
              <div class="performance-label">{{ key.replace('_', ' ').title() }}</div>
              <div class="progress-ring">
                <svg width="60" height="60">
                  <circle class="bg" cx="30" cy="30" r="25"></circle>
                  <circle class="progress" cx="30" cy="30" r="25" 
                          style="stroke-dashoffset: {{ 157 - (metric.percentage * 157 / 100) }};"></circle>
                </svg>
              </div>
            </div>
            {% endfor %}
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Notifications -->
    <div class="col-md-4">
      <div class="card">
        <div class="card-header">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
              <i class="fa fa-bell"></i> Notifications
            </h5>
            <button class="btn btn-sm btn-outline-primary" onclick="markAllRead()">
              Mark all read
            </button>
          </div>
        </div>
        <div class="card-body p-0" style="max-height: 400px; overflow-y: auto;">
          {% if notifications %}
          {% for notification in notifications %}
          <div class="notification-item {{ notification.type }} {% if not notification.read %}unread{% endif %}"
               onclick="markNotificationRead('{{ notification.id }}')">
            <div class="flex-grow-1">
              <h6 class="mb-1">{{ notification.title }}</h6>
              <p class="mb-1 small">{{ notification.message }}</p>
              <div class="small text-muted">{{ notification.timestamp.strftime('%I:%M %p') if notification.timestamp else 'Just now' }}</div>
            </div>
            {% if not notification.read %}
            <div class="text-primary">
              <i class="fa fa-circle" style="font-size: 0.5rem;"></i>
            </div>
            {% endif %}
          </div>
          {% endfor %}
          {% else %}
          <div class="text-center p-4 text-muted">
            <i class="fa fa-bell-slash fa-2x mb-2"></i>
            <p>No notifications</p>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Featured Tools -->
  {% if featured_tools %}
  <div class="row mb-4">
    <div class="col-12">
      <h3 class="mb-3"><i class="fa fa-star"></i> Featured Tools</h3>
      <div class="featured-tools">
        {% for tool in featured_tools %}
        <a href="{{ tool.url }}" class="tool-card">
          <div class="tool-image">
            <i class="{{ tool.icon }}"></i>
          </div>
          <div class="card-body p-3">
            <h5 class="mb-2">{{ tool.title }}</h5>
            <p class="text-muted mb-2">{{ tool.description }}</p>
            <div class="tool-features">
              {% for feature in tool.features %}
              <span class="feature-badge">{{ feature }}</span>
              {% endfor %}
            </div>
          </div>
        </a>
        {% endfor %}
      </div>
    </div>
  </div>
  {% endif %}

</div>
{% endblock %}

{% block tail_js %}
  {{ super() }}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
  <script>
    // Update current time
    function updateTime() {
      const now = new Date();
      const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      document.getElementById('currentTime').textContent = timeString;
    }
    
    updateTime();
    setInterval(updateTime, 1000);
    
    // Initialize charts
    {% if chart_data %}
    const userGrowthCtx = document.getElementById('userGrowthChart');
    if (userGrowthCtx) {
      new Chart(userGrowthCtx, {
        type: 'line',
        data: {
          labels: {{ chart_data.user_growth.labels | tojson }},
          datasets: [{
            label: 'Users',
            data: {{ chart_data.user_growth.data | tojson }},
            backgroundColor: 'rgba(102, 126, 234, 0.1)',
            borderColor: 'rgba(102, 126, 234, 1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4,
            pointBackgroundColor: '#fff',
            pointBorderColor: 'rgba(102, 126, 234, 1)',
            pointBorderWidth: 2,
            pointRadius: 6,
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              grid: {
                color: 'rgba(0,0,0,0.05)'
              },
              ticks: {
                callback: function(value) {
                  return value.toLocaleString();
                }
              }
            },
            x: {
              grid: {
                display: false
              }
            }
          },
          elements: {
            point: {
              hoverBackgroundColor: '#fff'
            }
          }
        }
      });
    }
    {% endif %}
    
    // Notification management
    function markNotificationRead(notificationId) {
      fetch('/dashboard/api/mark-notification-read', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({notification_id: notificationId})
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          const notification = document.querySelector(`[onclick*="${notificationId}"]`);
          if (notification) {
            notification.classList.remove('unread');
            const indicator = notification.querySelector('.fa-circle');
            if (indicator) {
              indicator.style.display = 'none';
            }
          }
        }
      })
      .catch(error => console.error('Error:', error));
    }
    
    function markAllRead() {
      const unreadNotifications = document.querySelectorAll('.notification-item.unread');
      unreadNotifications.forEach(notification => {
        notification.classList.remove('unread');
        const indicator = notification.querySelector('.fa-circle');
        if (indicator) {
          indicator.style.display = 'none';
        }
      });
    }
    
    // Auto-refresh dashboard data
    function refreshDashboardData() {
      // Update stats
      fetch('/dashboard/api/stats')
        .then(response => response.json())
        .then(data => {
          // Update stat values (simplified)
          console.log('Stats updated:', data);
        })
        .catch(error => console.error('Error refreshing stats:', error));
    }
    
    // Refresh every 30 seconds
    setInterval(refreshDashboardData, 30000);
    
    // Add smooth loading animations
    document.addEventListener('DOMContentLoaded', function() {
      // Animate stats cards
      const statCards = document.querySelectorAll('.stat-card');
      statCards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
          card.style.transition = 'all 0.6s ease';
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }, index * 100);
      });
      
      // Animate action cards
      const actionCards = document.querySelectorAll('.action-card');
      actionCards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'scale(0.9)';
        
        setTimeout(() => {
          card.style.transition = 'all 0.4s ease';
          card.style.opacity = '1';
          card.style.transform = 'scale(1)';
        }, 200 + index * 80);
      });
      
      // Animate progress rings
      setTimeout(() => {
        const progressRings = document.querySelectorAll('.progress-ring .progress');
        progressRings.forEach(ring => {
          const dashOffset = ring.style.strokeDashoffset;
          ring.style.strokeDashoffset = '157';
          setTimeout(() => {
            ring.style.strokeDashoffset = dashOffset;
          }, 500);
        });
      }, 1000);
    });
    
    // Add keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      // Ctrl/Cmd + / for search
      if ((e.ctrlKey || e.metaKey) && e.key === '/') {
        e.preventDefault();
        // Focus search if available
        const searchInput = document.querySelector('input[type="search"]');
        if (searchInput) {
          searchInput.focus();
        }
      }
      
      // Ctrl/Cmd + N for new wizard
      if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
        e.preventDefault();
        window.location.href = '/wizard-builder';
      }
    });
    
    // Add tooltips for better UX
    const tooltipElements = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    tooltipElements.forEach(element => {
      new bootstrap.Tooltip(element);
    });
    
    // Performance monitoring
    if ('performance' in window) {
      window.addEventListener('load', function() {
        const loadTime = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;
        console.log('Dashboard loaded in', loadTime + 'ms');
      });
    }
  </script>
{% endblock %}